import numpy as np
import pandas as pd

ret_code_lst = [
    408910,
    408909,
    408908,
    408907,
    408905,
    408906,
    400951,
    413030,
    413029,
    400057,
    413027,
    413028,
    400147,
    427922,
    427921,
    402937,
    400343,
    403263,
    418852,
    418851,
    401560,
    422357,
    422358,
    400045,
    408437,
    400122,
    408438,
    418849,
    401541,
    418850,
    422361,
    422359,
    422360,
    402281,
    402283,
    402285,
    423139,
    423140,
    402286,
    400088,
    402939,
    402940,
    413026,
    401464,
    403185,
    403186,
    401489,
    403187,
    401538,
    403188,
    402290,
    402292,
    403198,
    403194,
    401643,
    403200,
    403199,
    402800,
    402828,
    407219,
    402789,
    420001,
    420002,
    408755,
    418449,
    402802,
    425000,
    408756,
    429753,
    429757,
    402947,
    400189,
    402948,
    402949,
    400309,
    400417,
    402952,
    400249,
    402951,
    401639,
    402943,
    402956,
    402957,
    400662,
    400141,
    402960,
    400761,
    402962,
    402963,
    400490,
    401888,
    402967,
    402968,
    400137,
    402964,
    400716,
    401545,
    402972,
    402973,
    401011,
    400674,
    402976,
    400539,
    402980,
    400534,
    402981,
    401062,
    401529,
    401613,
    400536,
    402985,
    402986,
    402989,
    400488,
    401561,
    402990,
    400611,
    400928,
    403170,
    400284,
    400041,
    402995,
    402996,
    408133,
    408135,
    417665,
    412639,
    412640,
    412638,
    412637,
    417666,
    417667,
    408134,
    403113,
    400685,
    403114,
    403001,
    401003,
    403002,
    400898,
    403005,
    400275,
    403006,
    400939,
    400180,
    400529,
    400990,
    400515,
    405735,
    402168,
    418451,
    400252,
    403008,
    400788,
    427924,
    403011,
    401517,
    401871,
    400574,
    418450,
    401629,
    400422,
    403018,
    403016,
    400333,
    403017,
    410363,
    403020,
    400360,
    403021,
    400955,
    403024,
    400495,
    410367,
    410366,
    410364,
    400608,
    403029,
    400949,
    403028,
    400678,
    403030,
    400341,
    403035,
    403034,
    403036,
    400607,
    403039,
    403041,
    400094,
    400682,
    403043,
    403044,
    408138,
    408139,
    400980,
    403047,
    401333,
    401142,
    425396,
    404746,
    400218,
    424999,
    400983,
    400765,
    400923,
    403104,
    400844,
    401143,
    402965
]

lat_lst = [
    "37.319644",
    "37.319935",
    "37.320661",
    "37.321822",
    "37.32414",
    "37.324285",
    "37.325584",
    "37.335022",
    "37.335022",
    "37.335022",
    "37.34221",
    "37.34221",
    "37.34221",
    "37.343965",
    "37.343965",
    "37.348907",
    "37.348907",
    "37.349102",
    "37.357413",
    "37.357526",
    "37.357526",
    "37.35866",
    "37.35866",
    "37.363402",
    "37.363402",
    "37.36614",
    "37.36614",
    "37.370203",
    "37.370203",
    "37.370203",
    "37.378987",
    "37.380936",
    "37.380936",
    "37.38449",
    "37.391595",
    "37.398698",
    "37.403823",
    "37.404251",
    "37.405824",
    "37.414988",
    "37.415548",
    "37.415548",
    "37.421232",
    "37.424833",
    "37.424833",
    "37.424833",
    "37.427486",
    "37.430444",
    "37.430587",
    "37.430587",
    "37.436753",
    "37.445371",
    "37.56227",
    "37.451256",
    "37.456422",
    "37.450681",
    "37.450825",
    "37.463015",
    "37.467739",
    "37.477872",
    "37.481245",
    "37.480308",
    "37.480844",
    "37.483198",
    "37.483198",
    "37.484332",
    "37.484973",
    "37.485075",
    "37.487011",
    "37.487832",
    "37.492185",
    "37.493107",
    "37.493107",
    "37.49411",
    "37.495016",
    "37.500569",
    "37.506892",
    "37.506892",
    "37.506892",
    "37.508725",
    "37.509242",
    "37.520806",
    "37.522223",
    "37.522375",
    "37.523522",
    "37.523755",
    "37.529397",
    "37.529397",
    "37.529397",
    "37.531271",
    "37.541569",
    "37.544658",
    "37.54653",
    "37.54653",
    "37.54876",
    "37.54901",
    "37.559198",
    "37.562052",
    "37.563362",
    "37.563362",
    "37.565692",
    "37.565692",
    "37.572566",
    "37.576193",
    "37.581087",
    "37.581087",
    "37.58562",
    "37.589488",
    "37.592711",
    "37.600243",
    "37.600243",
    "37.604734",
    "37.608066",
    "37.608066",
    "37.614012",
    "37.619533",
    "37.619533",
    "37.62282",
    "37.630267",
    "37.630267",
    "37.633535",
    "37.633535",
    "37.63366",
    "37.637181",
    "37.639571",
    "37.6431",
    "37.644474",
    "37.6446",
    "37.645621",
    "37.645749",
    "37.646129",
    "37.646129",
    "37.652145",
    "37.654859",
    "37.654859",
    "37.654988",
    "37.659267",
    "37.659267",
    "37.659397",
    "37.661989",
    "37.664588",
    "37.667821",
    "37.667821",
    "37.670921",
    "37.674405",
    "37.677613",
    "37.680566",
    "37.683298",
    "37.683774",
    "37.687544",
    "37.687544",
    "37.687544",
    "37.68978",
    "37.691415",
    "37.6919",
    "37.691998",
    "37.703862",
    "37.707384",
    "37.711717",
    "37.711717",
    "37.714115",
    "37.715784",
    "37.719584",
    "37.719584",
    "37.719584",
    "37.719697",
    "37.723421",
    "37.729878",
    "37.730698",
    "37.731528",
    "37.732945",
    "37.733652",
    "37.74205",
    "37.740346",
    "37.740587",
    "37.741681",
    "37.740952",
    "37.756731",
    "37.756731",
    "37.756731",
    "37.764978",
    "37.765099",
    "37.771469",
    "37.771469",
    "37.77155",
    "37.77487",
    "37.77487",
    "37.776769",
    "37.776769",
    "37.776769",
    "37.779555",
    "37.779555",
    "37.780243",
    "37.794185",
    "37.794185",
    "37.797439",
    "37.797439",
    "37.801768",
    "37.802856",
    "37.802221",
    "37.802829",
    "37.803542",
    "37.80551",
    "37.786336",
    "37.811809",
    "37.824153",
    "37.822794",
    "37.822794",
    "37.829005",
    "37.531353"
]

lng_lst = [
    "-121.940183",
    "-121.940207",
    "-121.940285",
    "-121.940425",
    "-121.940638",
    "-121.94065",
    "-121.940683",
    "-121.935522",
    "-121.935522",
    "-121.935522",
    "-121.926305",
    "-121.926305",
    "-121.926305",
    "-121.924519",
    "-121.924519",
    "-121.917833",
    "-121.917833",
    "-121.917563",
    "-121.907997",
    "-121.907884",
    "-121.907884",
    "-121.906756",
    "-121.906756",
    "-121.902233",
    "-121.902233",
    "-121.901132",
    "-121.901132",
    "-121.901514",
    "-121.901514",
    "-121.901514",
    "-121.903542",
    "-121.904008",
    "-121.904008",
    "-121.904845",
    "-121.906506",
    "-121.908172",
    "-121.909377",
    "-121.909479",
    "-121.909842",
    "-121.912685",
    "-121.912875",
    "-121.912875",
    "-121.914808",
    "-121.916049",
    "-121.916049",
    "-121.916049",
    "-121.916962",
    "-121.917891",
    "-121.917925",
    "-121.917925",
    "-121.919191",
    "-121.920853",
    "-122.036931",
    "-121.922021",
    "-121.923067",
    "-121.921909",
    "-121.921937",
    "-121.925972",
    "-121.928329",
    "-121.93334",
    "-121.935022",
    "-121.93453",
    "-121.93481",
    "-121.936428",
    "-121.936428",
    "-121.93758",
    "-121.938331",
    "-121.938463",
    "-121.940971",
    "-121.942019",
    "-121.947724",
    "-121.948928",
    "-121.948928",
    "-121.950208",
    "-121.951359",
    "-121.958606",
    "-121.966671",
    "-121.966671",
    "-121.966671",
    "-121.968989",
    "-121.969628",
    "-121.984229",
    "-121.986981",
    "-121.987291",
    "-121.989607",
    "-121.990066",
    "-122.001271",
    "-122.001271",
    "-122.001271",
    "-122.004734",
    "-122.018846",
    "-122.021179",
    "-122.022581",
    "-122.022581",
    "-122.024268",
    "-122.02445",
    "-122.03362",
    "-122.036693",
    "-122.038123",
    "-122.038123",
    "-122.040628",
    "-122.040628",
    "-122.045996",
    "-122.047274",
    "-122.048943",
    "-122.048943",
    "-122.051459",
    "-122.054221",
    "-122.056527",
    "-122.061912",
    "-122.061912",
    "-122.065032",
    "-122.067407",
    "-122.067407",
    "-122.071623",
    "-122.075651",
    "-122.075651",
    "-122.077983",
    "-122.083308",
    "-122.083308",
    "-122.085656",
    "-122.085656",
    "-122.085746",
    "-122.088255",
    "-122.089968",
    "-122.092479",
    "-122.093492",
    "-122.09358",
    "-122.094269",
    "-122.094355",
    "-122.094618",
    "-122.094618",
    "-122.09861",
    "-122.100333",
    "-122.100333",
    "-122.100415",
    "-122.103058",
    "-122.103058",
    "-122.103135",
    "-122.104729",
    "-122.106305",
    "-122.108348",
    "-122.108348",
    "-122.110371",
    "-122.114201",
    "-122.118725",
    "-122.123107",
    "-122.126995",
    "-122.127702",
    "-122.133225",
    "-122.133225",
    "-122.133225",
    "-122.136442",
    "-122.138842",
    "-122.139544",
    "-122.139682",
    "-122.156797",
    "-122.161886",
    "-122.168258",
    "-122.168258",
    "-122.171416",
    "-122.173158",
    "-122.177086",
    "-122.177086",
    "-122.177086",
    "-122.1772",
    "-122.180982",
    "-122.186837",
    "-122.187572",
    "-122.188289",
    "-122.189517",
    "-122.190132",
    "-122.19753",
    "-122.196016",
    "-122.196231",
    "-122.197207",
    "-122.196557",
    "-122.210399",
    "-122.210399",
    "-122.210399",
    "-122.217592",
    "-122.217693",
    "-122.22307",
    "-122.22307",
    "-122.223223",
    "-122.232742",
    "-122.232742",
    "-122.236107",
    "-122.236107",
    "-122.236107",
    "-122.237925",
    "-122.237925",
    "-122.238194",
    "-122.264627",
    "-122.264627",
    "-122.271974",
    "-122.271974",
    "-122.283102",
    "-122.286698",
    "-122.294876",
    "-122.286516",
    "-122.301498",
    "-122.303473",
    "-122.245364",
    "-122.303409",
    "-122.291162",
    "-122.291843",
    "-122.291843",
    "-122.292846",
    "-122.004885"
]

lat_lst = [float(x) for x in lat_lst]
lng_lst = [float(x) for x in lng_lst]

df = pd.DataFrame.from_dict({"ID": ret_code_lst, "Lat": lat_lst, "Lng": lng_lst})
df.to_csv("data/station_raw.csv", index = False)

segment_range_dct = {
    "3420 - Auto Mall N": [(min(lat_lst), max(lng_lst)), (37.507417, -121.967227)],
    "3430 - Mowry NB": [(37.507417, -121.967227), (37.529878, -122.001944)],
    "3440 - Decoto/84 NB": [(37.529878, -122.001944), (37.563748, -122.038471)],
    "3450 - Whipple NB": [(37.563748, -122.038471), (37.606845, -122.066490)],
    "3460 - Hesperian/238 NB": [(37.606845, -122.066490), (max(lat_lst), min(lng_lst))] #(37.656561, -122.101390)
}
df = pd.read_csv("data/station_raw.csv")
seg_lst = []
for i in range(df.shape[0]):
    lat, lng = df.iloc[i]["Lat"], df.iloc[i]["Lng"]
    for segment in segment_range_dct:
        seg_range = segment_range_dct[segment]
        if (lat >= seg_range[0][0] and lat <= seg_range[1][0]) and (lng <= seg_range[0][1] and lng >= seg_range[1][1]):
            seg_lst.append(segment)
            break
df["Segment"] = seg_lst
df.to_csv("data/station_meta.csv")
